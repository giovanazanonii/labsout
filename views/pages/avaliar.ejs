<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LABSOUT</title>
    <link rel="icon" href="/imagens/icone.png" type="image/png">
    <link rel="stylesheet" href="/css/avaliar.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css">
    <style>
        .navbar a {
            color: #fff;
            text-decoration: none; 
        }
        .navbar a:hover {
            color: #ddd;
        }
        .navbar-title {
            color: #fff;
            font-size: 20px;
            margin-left: 10px; 
        }
        textarea::placeholder {
            font-size: 14px; /* Altere o tamanho conforme necessário */
            color: #c4c4c4; /* Opcional: mudar a cor do texto */
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="navbar-left">
            <a href="/inicialusuario" class="navbar-icon">
                <i class="bi bi-calendar2-week"></i>
            </a>
            <span class="navbar-title"><strong>LABSOUT</strong></span> 
        </div>
    </nav>

    <h2>Avalie sua experiência</h2>

    <div class="limite">
        <h4>Escreva aqui: </h4>

        <div class="char-count">
            Quantidade de caracteres:  
            <span id="charCount">200</span>
        </div>
    
        <div class="area-texto">
            <textarea id="textInput" rows="4" maxlength="140" placeholder="Compartilhe sua experiência conosco! Sua opinião é essencial para tornar nossa plataforma ainda melhor." oninput="postar()"></textarea>
    
            <div class="avaliacao">
                <span>Avalie com estrelas</span>
                <div class="estrelas">
                    <i class="bi bi-star" data-value="1"></i>
                    <i class="bi bi-star" data-value="2"></i>
                    <i class="bi bi-star" data-value="3"></i>
                    <i class="bi bi-star" data-value="4"></i>
                    <i class="bi bi-star" data-value="5"></i>
                </div>
            </div>
    
        </div>
    
        <button class="btn-postar"><strong>Postar</strong></button>
    </div>


<br><br><br><br>
    <div class="comentarios">
        <h3>Comentários de outros usuários</h3>
        <div id="comentarios-lista">
            <!-- Comentários de exemplo (já feitos) -->
            <div class="comentario-item">

                <div class="detalhes">
                    <div class="usuario">João Silva</div>
                    <div class="estrelas">
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star"></i>
                        <i class="bi bi-star"></i>
                    </div>
                    <div class="data">11/11/2024 15:30</div>
                    <div class="texto">Gostei muito da experiência, tudo foi muito bom!</div>
                </div>
            </div>
            <div class="comentario-item">
                <div class="detalhes">
                    <div class="usuario">Maria Oliveira</div>
                    <div class="estrelas">
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star"></i>
                    </div>
                    <div class="data">10/11/2024 14:45</div>
                    <div class="texto">A plataforma é muito intuitiva, adorei!</div>
                </div>
            </div>
        </div>
    </div>

    <script>
                document.querySelector('.btn-postar').addEventListener('click', () => {
                const comentario = document.getElementById('textInput').value;
                const nota = document.querySelectorAll('.bi-star-fill').length;
                const id_reserva = 1;
                const id_usuario = 2;

                fetch('/avaliacao', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ id_reserva, id_usuario, nota, comentario })
                })
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                })
                .catch(error => console.error('Erro:', error));
            });


        // Função para atualizar a contagem de caracteres
        function postar() {
            const textInput = document.getElementById("textInput");
            const charCount = document.getElementById("charCount");
            const maxLength = textInput.getAttribute("maxlength");
            charCount.textContent = maxLength - textInput.value.length;
        }

      // Função para avaliar com estrelas
            const estrelas = document.querySelectorAll('.estrelas .bi-star');
            estrelas.forEach((estrela, index) => {
            estrela.addEventListener('click', () => {
        // Limpa as classes 'bi-star-fill' de todas as estrelas
            estrelas.forEach(e => {
            e.classList.remove('bi-star-fill');
            e.classList.add('bi-star');
        });

        // Adiciona a classe 'bi-star-fill' às estrelas até a clicada
            for (let i = 0; i <= index; i++) {
                estrelas[i].classList.remove('bi-star');
                estrelas[i].classList.add('bi-star-fill');
        }
    });
});


// Comentários de exemplo (já feitos)
const comentarios = [
    {
        nome: "João Silva",
        estrelas: 3,
        data: "11/11/2024 15:30",
        comentario: "Gostei muito da experiência, tudo foi muito bom!"
    },
    {
        nome: "Maria Oliveira",
        estrelas: 4,
        data: "10/11/2024 14:45",
        comentario: "A plataforma é muito intuitiva, adorei!"
    }
];

// Função para adicionar os comentários dinamicamente
function exibirComentarios() {
    const comentariosLista = document.getElementById('comentarios-lista');
    
    comentarios.forEach(comentario => {
        const comentarioItem = document.createElement('div');
        comentarioItem.classList.add('comentario-item');

        // Estrelas
        let estrelasHTML = '';
        for (let i = 1; i <= 5; i++) {
            estrelasHTML += (i <= comentario.estrelas) ? 
                '<i class="bi bi-star-fill"></i>' : 
                '<i class="bi bi-star"></i>';
        }

        comentarioItem.innerHTML = `
            <div class="detalhes">
                <div class="usuario">${comentario.nome}</div>
                <div class="estrelas">${estrelasHTML}</div>
                <div class="data">${comentario.data}</div>
                <div class="texto">${comentario.comentario}</div>
            </div>
        `;
        comentariosLista.appendChild(comentarioItem);
    });
}

// Chamar a função para exibir os comentários
exibirComentarios();

    </script>
</body>
</html>
